<html>
<head>
		<title>Sign Up</title>
			<link rel="stylesheet" href="styles.css">
			<meta http-equiv="Content-Type" content="text/html, charset=UTF-8" />
			</head>
		<body>
<div class="topnav">
<a class="active" href="./">Home</a>
  <a>Please register yourself</a>
</div>
</br>

		<form method="post" action="signup.php">
		<input type="text" name="newpseudo" placeholder="Please enter a pseudo" value="" />
		<input type="password" name="newpasswd" placeholder="Please enter a password" value="" />
		<input type="submit" name="submit" value="CrÃ©er un compte" />
		</form>

<?php
$dsn = "mysql:host=localhost;dbname=scrowdb"; 
$username = "root";
$password = "toor";

try {
	$pdo = new PDO($dsn, $username, $password);
} catch (PDOException $e) {
	print "Error connection failed : ". $e->getMessage() . "<br/>";
	die();
}

#Sign up
if(isset($_POST['newpseudo']) && isset($_POST['newpasswd'])) {
	$valeurs = ["pseudo" => $_POST["newpseudo"], "passwd" => $_POST["newpasswd"]];
	$req = "INSERT INTO users (pseudo, passwd) VALUES (:pseudo, :passwd)";
	$req = $pdo->prepare($req);
	$req->execute($valeurs);
	$pseudo = $_POST['newpseudo'];
	setCookie("user", $pseudo);
	header("Location: profile.php?pseudo=".$pseudo);

} 
?>

</body>
</html>	
